<!-- templates/partials/navbar.html -->
<!-- Navbar atas minimal hanya muncul di perangkat kecil -->
<nav class="navbar navbar-dark bg-dark d-lg fixed-top" id="topNavbar">
    <div class="container-fluid">
        <a class="navbar-brand" href="{{ url_for('dashboard') }}">Lab Management</a>
        <button class="navbar-toggler" type="button" data-bs-toggle="offcanvas" data-bs-target="#sidebarMenu" aria-controls="sidebarMenu">
            <span class="navbar-toggler-icon"></span>
        </button>
    </div>
</nav>

<!-- Sidebar Offcanvas -->
<div class="offcanvas offcanvas-start bg-dark text-white" tabindex="-1" id="sidebarMenu" aria-labelledby="sidebarMenuLabel" style="width: 280px;">
    <div class="offcanvas-header">
        <h5 class="offcanvas-title" id="sidebarMenuLabel">Menu</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="offcanvas" aria-label="Close"></button>
    </div>
    <div class="offcanvas-body p-0">
        <!-- Gunakan list-group untuk gaya menu yang lebih modern -->
        <ul class="list-group list-group-flush">
            <!-- Dashboard -->
            <li class="list-group-item bg-dark border-0">
                <a class="nav-link text-white" href="{{ url_for('dashboard') }}">
                    <i class="bi bi-house-door me-2"></i>Dashboard
                </a>
            </li>

            <!-- Admin (Menu Utama) -->
            <li class="list-group-item bg-dark border-0">
                <a class="nav-link dropdown-toggle text-white" href="#" role="button" data-bs-toggle="collapse" data-bs-target="#adminCollapse" aria-expanded="false">
                    <i class="bi bi-gear me-2"></i>Admin
                </a>
                <div class="collapse" id="adminCollapse">
                    <ul class="nav flex-column ms-3">
                        <li class="nav-item">
                            <a class="nav-link text-white" href="{{ url_for('bahan_list', lab='Semua') }}">
                                <i class="bi bi-box me-2"></i>Bahan (Semua Lab)
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link text-white" href="{{ url_for('alat_list', lab='Semua') }}">
                                <i class="bi bi-tools me-2"></i>Alat (Semua Lab)
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link text-white" href="{{ url_for('kejadian_list', lab='Semua') }}">
                                <i class="bi bi-exclamation-triangle me-2"></i>Kejadian (Semua Lab)
                            </a>
                        </li>
                    </ul>
                </div>
            </li>

            <!-- Bahan -->
            <li class="list-group-item bg-dark border-0">
                <a class="nav-link dropdown-toggle text-white" href="#" role="button" data-bs-toggle="collapse" data-bs-target="#bahanCollapse" aria-expanded="false">
                    <i class="bi bi-droplet me-2"></i>Bahan
                </a>
                <div class="collapse" id="bahanCollapse">
                    <ul class="nav flex-column ms-3">
                        <li class="nav-item">
                            <a class="nav-link text-white" href="{{ url_for('bahan_list', lab='Fisika') }}">
                                <i class="bi bi-circle-fill me-2" style="color: #ff6b6b;"></i>Fisika
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link text-white" href="{{ url_for('bahan_list', lab='Kimia') }}">
                                <i class="bi bi-circle-fill me-2" style="color: #4ecdc4;"></i>Kimia
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link text-white" href="{{ url_for('bahan_list', lab='Biologi') }}">
                                <i class="bi bi-circle-fill me-2" style="color: #45b7d1;"></i>Biologi
                            </a>
                        </li>
                    </ul>
                </div>
            </li>

            <!-- Alat -->
            <li class="list-group-item bg-dark border-0">
                <a class="nav-link dropdown-toggle text-white" href="#" role="button" data-bs-toggle="collapse" data-bs-target="#alatCollapse" aria-expanded="false">
                    <i class="bi bi-wrench me-2"></i>Alat
                </a>
                <div class="collapse" id="alatCollapse">
                    <ul class="nav flex-column ms-3">
                        <li class="nav-item">
                            <a class="nav-link text-white" href="{{ url_for('alat_list', lab='Fisika') }}">
                                <i class="bi bi-circle-fill me-2" style="color: #ff6b6b;"></i>Fisika
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link text-white" href="{{ url_for('alat_list', lab='Kimia') }}">
                                <i class="bi bi-circle-fill me-2" style="color: #4ecdc4;"></i>Kimia
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link text-white" href="{{ url_for('alat_list', lab='Biologi') }}">
                                <i class="bi bi-circle-fill me-2" style="color: #45b7d1;"></i>Biologi
                            </a>
                        </li>
                    </ul>
                </div>
            </li>

            <!-- Kejadian -->
            <li class="list-group-item bg-dark border-0">
                <a class="nav-link dropdown-toggle text-white" href="#" role="button" data-bs-toggle="collapse" data-bs-target="#kejadianCollapse" aria-expanded="false">
                    <i class="bi bi-exclamation-triangle me-2"></i>Kejadian
                </a>
                <div class="collapse" id="kejadianCollapse">
                    <ul class="nav flex-column ms-3">
                        <!-- Tambah Kejadian -->
                        <li class="nav-item">
                            <span class="text-muted small">Tambah Kejadian</span>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link text-white" href="{{ url_for('kejadian_create', lab='Fisika') }}">
                                <i class="bi bi-plus-circle me-2"></i>Fisika
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link text-white" href="{{ url_for('kejadian_create', lab='Kimia') }}">
                                <i class="bi bi-plus-circle me-2"></i>Kimia
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link text-white" href="{{ url_for('kejadian_create', lab='Biologi') }}">
                                <i class="bi bi-plus-circle me-2"></i>Biologi
                            </a>
                        </li>
                        <li class="nav-item mt-2">
                            <span class="text-muted small">Daftar Kejadian</span>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link text-white" href="{{ url_for('kejadian_list', lab='Fisika') }}">
                                <i class="bi bi-list me-2"></i>Fisika
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link text-white" href="{{ url_for('kejadian_list', lab='Kimia') }}">
                                <i class="bi bi-list me-2"></i>Kimia
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link text-white" href="{{ url_for('kejadian_list', lab='Biologi') }}">
                                <i class="bi bi-list me-2"></i>Biologi
                            </a>
                        </li>
                    </ul>
                </div>
            </li>

            <!-- Download Jadwal -->
            <li class="list-group-item bg-dark border-0">
                <a class="nav-link dropdown-toggle text-white" href="#" role="button" data-bs-toggle="collapse" data-bs-target="#downloadCollapse" aria-expanded="false">
                    <i class="bi bi-download me-2"></i>Download Jadwal
                </a>
                <div class="collapse" id="downloadCollapse">
                    <ul class="nav flex-column ms-3">
                        <li class="nav-item">
                            <a class="nav-link text-white" href="{{ url_for('download_jadwal_excel', lab='Fisika') }}">
                                <i class="bi bi-file-earmark-excel me-2"></i>Lab Fisika
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link text-white" href="{{ url_for('download_jadwal_excel', lab='Kimia') }}">
                                <i class="bi bi-file-earmark-excel me-2"></i>Lab Kimia
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link text-white" href="{{ url_for('download_jadwal_excel', lab='Biologi') }}">
                                <i class="bi bi-file-earmark-excel me-2"></i>Lab Biologi
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link text-white" href="{{ url_for('download_jadwal_excel', lab='Semua') }}">
                                <i class="bi bi-file-earmark-excel me-2"></i>Semua Lab
                            </a>
                        </li>
                    </ul>
                </div>
            </li>

            <!-- Analitik -->
            <li class="list-group-item bg-dark border-0">
                <a class="nav-link text-white" href="{{ url_for('analytics_dashboard') }}">
                    <i class="bi bi-graph-up me-2"></i>ðŸ“Š Analitik
                </a>
            </li>

            <!-- Berita Acara -->
            <li class="list-group-item bg-dark border-0">
                <a class="nav-link dropdown-toggle text-white" href="#" role="button" data-bs-toggle="collapse" data-bs-target="#beritaAcaraCollapse" aria-expanded="false">
                    <i class="bi bi-journal-text me-2"></i>ðŸ“„ Berita Acara
                </a>
                <div class="collapse" id="beritaAcaraCollapse">
                    <ul class="nav flex-column ms-3">
                        <li class="nav-item">
                            <a class="nav-link text-white" href="{{ url_for('berita_acara_list') }}">
                                <i class="bi bi-list-check me-2"></i>Daftar Berita Acara
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link text-white" href="{{ url_for('berita_acara_penghapusan_create') }}">
                                <i class="bi bi-trash me-2"></i>Tambah Penghapusan
                            </a>
                        </li>
                    </ul>
                </div>
            </li>

            <!-- Logout -->
            <li class="list-group-item bg-dark border-0 mt-3">
                <a class="nav-link text-white btn btn-outline-light btn-sm w-100" href="{{ url_for('logout') }}">
                    <i class="bi bi-box-arrow-right me-2"></i>Logout
                </a>
            </li>
        </ul>
    </div>
</div>

<!-- Navbar hanya muncul di layar besar (lg dan ke atas) -->
<nav class="navbar navbar-expand-lg navbar-dark bg-dark mb-4 d-none d-lg-block">
    <div class="container-fluid">
        <a class="navbar-brand" href="{{ url_for('dashboard') }}" id="labManagementBrand">Lab Management</a>
        <div class="navbar-nav ms-auto">
            <!-- Anda bisa menambahkan item navbar desktop di sini jika perlu -->
            <a class="nav-link btn btn-outline-light btn-sm ms-2" href="{{ url_for('logout') }}">Logout</a>
        </div>
    </div>
</nav>

<!-- Script untuk mengontrol sidebar saat hover atau klik -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    const brand = document.getElementById('labManagementBrand');
    const sidebar = document.getElementById('sidebarMenu');

    // Fungsi untuk membuka sidebar
    function openSidebar() {
        const bsOffcanvas = new bootstrap.Offcanvas(sidebar);
        bsOffcanvas.show();
    }

    // Fungsi untuk menutup sidebar
    function closeSidebar() {
        const bsOffcanvas = new bootstrap.Offcanvas(sidebar);
        bsOffcanvas.hide();
    }

    // Event listener untuk hover (untuk desktop)
    if (window.innerWidth >= 992) { // lg breakpoint
        brand.addEventListener('mouseenter', function() {
            openSidebar();
        });

        brand.addEventListener('mouseleave', function() {
            // Tunda penutupan agar pengguna punya waktu untuk memindahkan cursor ke sidebar
            setTimeout(() => {
                if (!sidebar.matches(':hover')) {
                    closeSidebar();
                }
            }, 300); // 300ms delay
        });

        sidebar.addEventListener('mouseenter', function() {
            // Jangan tutup jika cursor di dalam sidebar
            clearTimeout(this.closeTimeout);
        });

        sidebar.addEventListener('mouseleave', function() {
            this.closeTimeout = setTimeout(closeSidebar, 300);
        });
    }

    // Event listener untuk klik (untuk semua perangkat)
    brand.addEventListener('click', function(e) {
        e.preventDefault(); // Mencegah default behavior
        openSidebar();
    });
});
</script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    const brand = document.getElementById('labManagementBrand');
    const sidebar = document.getElementById('sidebarMenu');
    let closeTimer = null;

    if (!brand || !sidebar) return;

    // Hanya aktif di desktop (lg ke atas)
    if (window.innerWidth < 992) return;

    function openSidebar() {
        if (closeTimer) clearTimeout(closeTimer);
        const bsOffcanvas = bootstrap.Offcanvas.getOrCreateInstance(sidebar);
        bsOffcanvas.show();
    }

    function scheduleClose() {
        closeTimer = setTimeout(() => {
            const bsOffcanvas = bootstrap.Offcanvas.getInstance(sidebar);
            if (bsOffcanvas) bsOffcanvas.hide();
        }, 300);
    }

    // Hover di brand â†’ buka
    brand.addEventListener('mouseenter', openSidebar);

    // Hover di brand â†’ jangan tutup
    brand.addEventListener('mouseleave', scheduleClose);

    // Hover di sidebar â†’ batalkan penutupan
    sidebar.addEventListener('mouseenter', () => {
        if (closeTimer) clearTimeout(closeTimer);
    });

    // Hover keluar sidebar â†’ jadwalkan tutup
    sidebar.addEventListener('mouseleave', scheduleClose);

    // Klik di brand â†’ buka (opsional, bisa dihapus jika hanya hover)
    brand.addEventListener('click', function (e) {
        e.preventDefault();
        openSidebar();
    });
});
</script>